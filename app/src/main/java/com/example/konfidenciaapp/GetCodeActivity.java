package com.example.konfidenciaapp;import androidx.appcompat.app.AppCompatActivity;import android.content.Intent;import android.os.Bundle;import android.view.View;import android.widget.Button;import android.widget.EditText;import android.widget.TextView;import com.basgeekball.awesomevalidation.AwesomeValidation;import com.basgeekball.awesomevalidation.ValidationStyle;import com.basgeekball.awesomevalidation.utility.RegexTemplate;import com.example.konfidenciaapp.crm_1c.Client;import com.google.common.collect.Range;import java.io.IOException;import okhttp3.ResponseBody;import retrofit2.Call;import retrofit2.Callback;import retrofit2.Response;import retrofit2.Retrofit;import retrofit2.converter.gson.GsonConverterFactory;public class GetCodeActivity extends AppCompatActivity {    private  String URL_FOR_GET = "http://84.204.149.203:8888/medicine_test/hs/konfidenciamobile/events/pacient/info/";    private TextView textView;    private EditText enter_code;    private Button send_code;    private AwesomeValidation awesomeValidation;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_code);        send_code = findViewById(R.id.send_code);        textView = findViewById(R.id.firstPhone);        enter_code = findViewById(R.id.enter_code);        Bundle extras = getIntent().getExtras();        String phone = extras.getString("phone");        StringBuilder splitPhone = new StringBuilder(phone);        splitPhone.insert(0," ");        splitPhone.insert(4," ");        splitPhone.insert(8,"-");        splitPhone.insert(11,"-");        textView.setText("+7"+splitPhone);        awesomeValidation = new AwesomeValidation(ValidationStyle.BASIC);        awesomeValidation.addValidation(this,R.id.enter_code, RegexTemplate.NOT_EMPTY,R.string.invalid_code);        send_code.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                if (awesomeValidation.validate()){                    getUserByPhone(phone);                }            }        });    }    private void getUserByPhone(String phone) {        Retrofit retrofit = new Retrofit.Builder()                .baseUrl(URL_FOR_GET)                .addConverterFactory(GsonConverterFactory.create())                .build();        JsonPlaceHolderApi jsonPlaceHolderApi = retrofit.create(JsonPlaceHolderApi.class);        Call<Client> call = jsonPlaceHolderApi.getUser("as_konfidencia_mobile_app","8" + phone);        call.enqueue(new Callback<Client>() {            @Override            public void onResponse(Call<Client> call, Response<Client> response) {                if (response.isSuccessful()) {                    Client client = response.body();                    Intent intent = new Intent(GetCodeActivity.this, PersonalAccountActivity.class);                    intent.putExtra("full_name",client.getParameters().getFull_name());                    intent.putExtra("first_name",client.getParameters().getFirst_name());                    intent.putExtra("middle_name",client.getParameters().getMiddle_name());                    intent.putExtra("last_name",client.getParameters().getLast_name());                    intent.putExtra("birthday",client.getParameters().getBirthday());                    intent.putExtra("sex",client.getParameters().getSex());                    intent.putExtra("email",client.getParameters().getEmail());                    intent.putExtra("mobile",client.getParameters().getMobile());                    startActivity(intent);                    System.out.println(client);                } else {                    System.out.println(response.code() + "" + response.message());                    ResponseBody errorBody = response.errorBody();                    if (errorBody != null) {                        try {                            System.out.println("Error body:\n" + errorBody.string());                        } catch (IOException e) {                            e.printStackTrace();                        }                    }                    Intent intent = new Intent(GetCodeActivity.this, AddUserActivity.class);                    intent.putExtra("mobile_phone", phone);                    startActivity(intent);                }            }            @Override            public void onFailure(Call<Client> call, Throwable t) {                System.out.println(t);            }        });    }}